{
  "info": {
    "name": "TPI Backend 2025 - Complete",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Colecci√≥n completa con todos los endpoints del TPI Backend 2025",
    "_postman_id": "tpi-backend-2025-complete",
    "version": "2.0.0"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwt_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "üîê Authentication",
      "description": "Autenticaci√≥n con Keycloak",
      "item": [
        {
          "name": "Login - Cliente",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('jwt_token', jsonData.access_token);",
                  "    pm.environment.set('refresh_token', jsonData.refresh_token);",
                  "    console.log('‚úÖ Token de CLIENTE guardado');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password",
                  "type": "text"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client",
                  "type": "text"
                },
                {
                  "key": "username",
                  "value": "cliente01",
                  "type": "text"
                },
                {
                  "key": "password",
                  "value": "cliente123",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        },
        {
          "name": "Login - Operador",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('jwt_token', jsonData.access_token);",
                  "    pm.environment.set('refresh_token', jsonData.refresh_token);",
                  "    console.log('‚úÖ Token de OPERADOR guardado');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password",
                  "type": "text"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client",
                  "type": "text"
                },
                {
                  "key": "username",
                  "value": "operador01",
                  "type": "text"
                },
                {
                  "key": "password",
                  "value": "operador123",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        },
        {
          "name": "Login - Transportista",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('jwt_token', jsonData.access_token);",
                  "    pm.environment.set('refresh_token', jsonData.refresh_token);",
                  "    console.log('‚úÖ Token de TRANSPORTISTA guardado');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password",
                  "type": "text"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client",
                  "type": "text"
                },
                {
                  "key": "username",
                  "value": "transportista01",
                  "type": "text"
                },
                {
                  "key": "password",
                  "value": "trans123",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "üì¶ Orders Service",
      "description": "Gesti√≥n de solicitudes y contenedores",
      "item": [
        {
          "name": "Crear Solicitud (CLIENTE)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('solicitud_id', jsonData.id);",
                  "    pm.environment.set('contenedor_id', jsonData.contenedor.id);",
                  "    console.log('‚úÖ Solicitud creada: ' + jsonData.id);",
                  "    console.log('‚úÖ Contenedor creado: ' + jsonData.contenedor.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cliente\": {\n    \"nombre\": \"ACME Corporation\",\n    \"email\": \"contacto@acme.com\",\n    \"telefono\": \"+54 11 5555-1234\"\n  },\n  \"contenedor\": {\n    \"peso\": 1200.5,\n    \"volumen\": 28.4\n  },\n  \"origen\": \"Buenos Aires, Argentina\",\n  \"origenLat\": -34.6037,\n  \"origenLng\": -58.3816,\n  \"destino\": \"C√≥rdoba, Argentina\",\n  \"destinoLat\": -31.4201,\n  \"destinoLng\": -64.1888,\n  \"estadiaEstimada\": 500.0\n}"
            },
            "url": "{{orders_base_url}}"
          }
        },
        {
          "name": "Obtener Solicitud por ID",
          "request": {
            "method": "GET",
            "url": "{{orders_base_url}}/{{solicitud_id}}"
          }
        },
        {
          "name": "Tracking de Contenedor (P√∫blico)",
          "request": {
            "method": "GET",
            "url": "{{orders_base_url}}/{{solicitud_id}}/tracking",
            "description": "Endpoint p√∫blico para seguimiento del contenedor"
          }
        },
        {
          "name": "Calcular Estimaci√≥n (OPERADOR)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"precioCombustible\": 750.50,\n  \"estadiaEstimada\": 500.0\n}"
            },
            "url": "{{orders_base_url}}/{{solicitud_id}}/estimacion",
            "description": "Calcula costo y tiempo usando distance-client y m√©tricas de flota"
          }
        },
        {
          "name": "Actualizar Costo Final (OPERADOR)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"costoFinal\": 45000.00,\n  \"tiempoRealMinutos\": 720\n}"
            },
            "url": "{{orders_base_url}}/{{solicitud_id}}/costo"
          }
        },
        {
          "name": "Cambiar Estado Manualmente (OPERADOR)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"estado\": \"PROGRAMADA\"\n}"
            },
            "url": "{{orders_base_url}}/{{solicitud_id}}/estado"
          }
        }
      ]
    },
    {
      "name": "üöõ Fleet Service",
      "description": "Gesti√≥n de camiones y tarifas",
      "item": [
        {
          "name": "Camiones",
          "item": [
            {
              "name": "Crear Cami√≥n (OPERADOR)",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 201 || pm.response.code === 200) {",
                      "    var jsonData = pm.response.json();",
                      "    pm.environment.set('camion_id', jsonData.id);",
                      "    console.log('‚úÖ Cami√≥n creado: ' + jsonData.id);",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dominio\": \"AA123BB\",\n  \"transportistaNombre\": \"Transportes del Sur S.A.\",\n  \"telefono\": \"+54-11-4567-8901\",\n  \"capPeso\": 25000.0,\n  \"capVolumen\": 60.0,\n  \"disponible\": true,\n  \"costoKmBase\": 950.0,\n  \"consumoLKm\": 0.32\n}"
                },
                "url": "{{fleet_base_url}}/trucks"
              }
            },
            {
              "name": "Listar Todos los Camiones",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/trucks"
              }
            },
            {
              "name": "Listar Camiones Disponibles",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/trucks?disponible=true"
              }
            },
            {
              "name": "Listar Camiones Ocupados",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/trucks?disponible=false"
              }
            },
            {
              "name": "Obtener Cami√≥n por ID",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/trucks/{{camion_id}}"
              }
            },
            {
              "name": "Actualizar Cami√≥n (OPERADOR)",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"disponible\": false,\n  \"costoKmBase\": 1000.0\n}"
                },
                "url": "{{fleet_base_url}}/trucks/{{camion_id}}"
              }
            }
          ]
        },
        {
          "name": "Tarifas",
          "item": [
            {
              "name": "Crear Tarifa (OPERADOR)",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 201 || pm.response.code === 200) {",
                      "    var jsonData = pm.response.json();",
                      "    pm.environment.set('tarifa_id', jsonData.id);",
                      "    console.log('‚úÖ Tarifa creada: ' + jsonData.id);",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"tipo\": \"CARGO_GESTION_POR_TRAMO\",\n  \"valor\": 5000.0,\n  \"descripcion\": \"Cargo fijo de gesti√≥n por cada tramo\"\n}"
                },
                "url": "{{fleet_base_url}}/tarifas"
              }
            },
            {
              "name": "Listar Tarifas",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/tarifas"
              }
            },
            {
              "name": "Obtener Tarifa por Tipo",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/tarifas/tipo/CARGO_GESTION_POR_TRAMO"
              }
            },
            {
              "name": "Actualizar Tarifa (OPERADOR)",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"valor\": 5500.0,\n  \"descripcion\": \"Cargo de gesti√≥n actualizado\"\n}"
                },
                "url": "{{fleet_base_url}}/tarifas/{{tarifa_id}}"
              }
            }
          ]
        },
        {
          "name": "M√©tricas",
          "item": [
            {
              "name": "Obtener Promedios de Flota",
              "request": {
                "method": "GET",
                "url": "{{fleet_base_url}}/metrics/promedios",
                "description": "Retorna consumo promedio y costo por km promedio de camiones disponibles"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "üó∫Ô∏è Logistics Service",
      "description": "Gesti√≥n de rutas, tramos y dep√≥sitos",
      "item": [
        {
          "name": "Dep√≥sitos",
          "item": [
            {
              "name": "Crear Dep√≥sito (OPERADOR)",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 201 || pm.response.code === 200) {",
                      "    var jsonData = pm.response.json();",
                      "    pm.environment.set('deposito_id', jsonData.id);",
                      "    console.log('‚úÖ Dep√≥sito creado: ' + jsonData.id);",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nombre\": \"Dep√≥sito Central Rosario\",\n  \"direccion\": \"Av. Belgrano 1250, Rosario, Santa Fe\",\n  \"lat\": -32.9468,\n  \"lng\": -60.6393,\n  \"costoEstadiaDia\": 800.0\n}"
                },
                "url": "{{logistics_base_url}}/depositos"
              }
            },
            {
              "name": "Listar Dep√≥sitos",
              "request": {
                "method": "GET",
                "url": "{{logistics_base_url}}/depositos"
              }
            },
            {
              "name": "Obtener Dep√≥sito por ID",
              "request": {
                "method": "GET",
                "url": "{{logistics_base_url}}/depositos/{{deposito_id}}"
              }
            },
            {
              "name": "Actualizar Dep√≥sito (OPERADOR)",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nombre\": \"Dep√≥sito Central Rosario - Actualizado\",\n  \"costoEstadiaDia\": 850.0\n}"
                },
                "url": "{{logistics_base_url}}/depositos/{{deposito_id}}"
              }
            }
          ]
        },
        {
          "name": "Rutas",
          "item": [
            {
              "name": "Crear Ruta (OPERADOR)",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 201 || pm.response.code === 200) {",
                      "    var jsonData = pm.response.json();",
                      "    pm.environment.set('ruta_id', jsonData.id);",
                      "    if (jsonData.tramos && jsonData.tramos.length > 0) {",
                      "        pm.environment.set('tramo_id', jsonData.tramos[0].id);",
                      "        console.log('‚úÖ Primer tramo: ' + jsonData.tramos[0].id);",
                      "    }",
                      "    console.log('‚úÖ Ruta creada: ' + jsonData.id);",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"origen\": {\n    \"tipo\": \"SOLICITUD\",\n    \"lat\": -34.6037,\n    \"lng\": -58.3816,\n    \"descripcion\": \"Buenos Aires\"\n  },\n  \"destino\": {\n    \"tipo\": \"SOLICITUD\",\n    \"lat\": -31.4201,\n    \"lng\": -64.1888,\n    \"descripcion\": \"C√≥rdoba\"\n  },\n  \"depositosIntermedios\": [\n    {\n      \"depositoId\": {{deposito_id}},\n      \"diasEstadia\": 2\n    }\n  ],\n  \"costoKmBase\": 950.0,\n  \"consumoLitrosKm\": 0.32,\n  \"precioCombustible\": 750.0,\n  \"pesoCarga\": 1200.5,\n  \"volumenCarga\": 28.4\n}"
                },
                "url": "{{logistics_base_url}}/routes",
                "description": "Crea ruta con tramos calculados usando distance-client"
              }
            },
            {
              "name": "Obtener Ruta por ID",
              "request": {
                "method": "GET",
                "url": "{{logistics_base_url}}/routes/{{ruta_id}}"
              }
            },
            {
              "name": "Asignar Ruta a Solicitud (OPERADOR)",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"solicitudId\": {{solicitud_id}}\n}"
                },
                "url": "{{logistics_base_url}}/routes/{{ruta_id}}/asignaciones"
              }
            }
          ]
        },
        {
          "name": "Tramos",
          "item": [
            {
              "name": "Asignar Cami√≥n a Tramo (OPERADOR)",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"camionId\": {{camion_id}},\n  \"pesoCarga\": 1200.5,\n  \"volumenCarga\": 28.4\n}"
                },
                "url": "{{logistics_base_url}}/tramos/{{tramo_id}}/asignaciones",
                "description": "Valida capacidad del cami√≥n antes de asignar"
              }
            },
            {
              "name": "Iniciar Tramo (TRANSPORTISTA)",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{}"
                },
                "url": "{{logistics_base_url}}/tramos/{{tramo_id}}/inicios"
              }
            },
            {
              "name": "Finalizar Tramo (TRANSPORTISTA)",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"kmReal\": 320.5,\n  \"precioCombustible\": 750.0,\n  \"costoKmBase\": 950.0,\n  \"consumoLitrosKm\": 0.35,\n  \"diasEstadia\": 1\n}"
                },
                "url": "{{logistics_base_url}}/tramos/{{tramo_id}}/finalizaciones",
                "description": "Recalcula distancia real con distance-client"
              }
            },
            {
              "name": "Listar Tramos de un Cami√≥n",
              "request": {
                "method": "GET",
                "url": "{{logistics_base_url}}/tramos/camion/{{camion_id}}",
                "description": "Para TRANSPORTISTA ver sus tramos asignados"
              }
            },
            {
              "name": "Contenedores en Dep√≥sito",
              "request": {
                "method": "GET",
                "url": "{{logistics_base_url}}/tramos/deposito/{{deposito_id}}/contenedores",
                "description": "Lista contenedores esperando en el dep√≥sito"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "üîÑ Flujo End-to-End Completo",
      "description": "Flujo completo desde solicitud hasta entrega",
      "item": [
        {
          "name": "1Ô∏è‚É£ Login Operador",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('jwt_token', jsonData.access_token);",
                  "    console.log('‚úÖ Autenticado como OPERADOR');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client"
                },
                {
                  "key": "username",
                  "value": "operador01"
                },
                {
                  "key": "password",
                  "value": "operador123"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        },
        {
          "name": "2Ô∏è‚É£ Crear Dep√≥sito",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    pm.environment.set('deposito_id', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Dep√≥sito Rosario\",\n  \"direccion\": \"Av. Belgrano 1250\",\n  \"lat\": -32.9468,\n  \"lng\": -60.6393,\n  \"costoEstadiaDia\": 800.0\n}"
            },
            "url": "{{logistics_base_url}}/depositos"
          }
        },
        {
          "name": "3Ô∏è‚É£ Crear Cami√≥n",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    pm.environment.set('camion_id', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dominio\": \"ABC123\",\n  \"transportistaNombre\": \"Transportes SA\",\n  \"telefono\": \"+54-11-1234-5678\",\n  \"capPeso\": 30000.0,\n  \"capVolumen\": 80.0,\n  \"disponible\": true,\n  \"costoKmBase\": 950.0,\n  \"consumoLKm\": 0.32\n}"
            },
            "url": "{{fleet_base_url}}/trucks"
          }
        },
        {
          "name": "4Ô∏è‚É£ Crear Tarifa Gesti√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tipo\": \"CARGO_GESTION_POR_TRAMO\",\n  \"valor\": 5000.0,\n  \"descripcion\": \"Cargo fijo por tramo\"\n}"
            },
            "url": {
              "raw": "{{gateway_base_url}}/api/tarifas",
              "host": [
                "{{orders_base_url}}"
              ],
              "path": [
                "api",
                "tarifas"
              ]
            }
          }
        },
        {
          "name": "5Ô∏è‚É£ Login Cliente",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    pm.environment.set('jwt_token', pm.response.json().access_token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client"
                },
                {
                  "key": "username",
                  "value": "cliente01"
                },
                {
                  "key": "password",
                  "value": "cliente123"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        },
        {
          "name": "6Ô∏è‚É£ Crear Solicitud",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    var data = pm.response.json();",
                  "    pm.environment.set('solicitud_id', data.id);",
                  "    pm.environment.set('contenedor_id', data.contenedor.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cliente\": {\n    \"nombre\": \"ACME Corp\",\n    \"email\": \"acme@example.com\",\n    \"telefono\": \"+54-11-1111-2222\"\n  },\n  \"contenedor\": {\n    \"peso\": 1500.0,\n    \"volumen\": 30.0\n  },\n  \"origen\": \"Buenos Aires\",\n  \"origenLat\": -34.6037,\n  \"origenLng\": -58.3816,\n  \"destino\": \"C√≥rdoba\",\n  \"destinoLat\": -31.4201,\n  \"destinoLng\": -64.1888,\n  \"estadiaEstimada\": 500.0\n}"
            },
            "url": "{{orders_base_url}}"
          }
        },
        {
          "name": "7Ô∏è‚É£ Login Operador",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    pm.environment.set('jwt_token', pm.response.json().access_token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client"
                },
                {
                  "key": "username",
                  "value": "operador01"
                },
                {
                  "key": "password",
                  "value": "operador123"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        },
        {
          "name": "8Ô∏è‚É£ Calcular Estimaci√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"precioCombustible\": 750.0,\n  \"estadiaEstimada\": 500.0\n}"
            },
            "url": "{{orders_base_url}}/{{solicitud_id}}/estimacion"
          }
        },
        {
          "name": "9Ô∏è‚É£ Crear Ruta",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    var data = pm.response.json();",
                  "    pm.environment.set('ruta_id', data.id);",
                  "    if (data.tramos && data.tramos.length > 0) {",
                  "        pm.environment.set('tramo_id', data.tramos[0].id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"origen\": {\n    \"tipo\": \"SOLICITUD\",\n    \"lat\": -34.6037,\n    \"lng\": -58.3816,\n    \"descripcion\": \"Buenos Aires\"\n  },\n  \"destino\": {\n    \"tipo\": \"SOLICITUD\",\n    \"lat\": -31.4201,\n    \"lng\": -64.1888,\n    \"descripcion\": \"C√≥rdoba\"\n  },\n  \"depositosIntermedios\": [\n    {\n      \"depositoId\": {{deposito_id}},\n      \"diasEstadia\": 2\n    }\n  ],\n  \"costoKmBase\": 950.0,\n  \"consumoLitrosKm\": 0.32,\n  \"precioCombustible\": 750.0,\n  \"pesoCarga\": 1500.0,\n  \"volumenCarga\": 30.0\n}"
            },
            "url": "{{logistics_base_url}}/routes"
          }
        },
        {
          "name": "üîü Asignar Ruta a Solicitud",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"solicitudId\": {{solicitud_id}}\n}"
            },
            "url": "{{logistics_base_url}}/routes/{{ruta_id}}/asignaciones"
          }
        },
        {
          "name": "1Ô∏è‚É£1Ô∏è‚É£ Asignar Cami√≥n a Tramo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"camionId\": {{camion_id}},\n  \"pesoCarga\": 1500.0,\n  \"volumenCarga\": 30.0\n}"
            },
            "url": "{{logistics_base_url}}/tramos/{{tramo_id}}/asignaciones"
          }
        },
        {
          "name": "1Ô∏è‚É£2Ô∏è‚É£ Login Transportista",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    pm.environment.set('jwt_token', pm.response.json().access_token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "tpi-client"
                },
                {
                  "key": "username",
                  "value": "transportista01"
                },
                {
                  "key": "password",
                  "value": "trans123"
                }
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/tpi-2025/protocol/openid-connect/token",
              "host": [
                "{{keycloak_url}}"
              ],
              "path": [
                "realms",
                "tpi-2025",
                "protocol",
                "openid-connect",
                "token"
              ]
            }
          }
        },
        {
          "name": "1Ô∏è‚É£3Ô∏è‚É£ Iniciar Tramo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": "{{logistics_base_url}}/tramos/{{tramo_id}}/inicios"
          }
        },
        {
          "name": "1Ô∏è‚É£4Ô∏è‚É£ Finalizar Tramo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"kmReal\": 320.5,\n  \"precioCombustible\": 750.0,\n  \"costoKmBase\": 950.0,\n  \"consumoLitrosKm\": 0.35,\n  \"diasEstadia\": 1\n}"
            },
            "url": "{{logistics_base_url}}/tramos/{{tramo_id}}/finalizaciones"
          }
        },
        {
          "name": "1Ô∏è‚É£5Ô∏è‚É£ Ver Tracking",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": "{{orders_base_url}}/{{solicitud_id}}/tracking"
          }
        }
      ]
    }
  ]
}